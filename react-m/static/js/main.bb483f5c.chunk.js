(this.webpackJsonpmanagement=this.webpackJsonpmanagement||[]).push([[0],{1259:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),s=(a(83),a(34)),i=(a(114),a(49)),l=(a(115),a(6)),u=a(13),p=a.n(u),m=(a(84),a(23)),d=a(28),h=a(17),f=a(18),g=a(21),b=a(19),v=a(20),y=(a(137),a(44)),E=a(112),O={saveUser:function(e){localStorage.setItem("user",JSON.stringify(e))},getUser:function(){return JSON.parse(localStorage.getItem("user")||"{}")},removeUser:function(){localStorage.removeItem("user")}},k=a(250),w=a.n(k);a(562);w.a.interceptors.request.use((function(e){e.method,e.data;return e})),w.a.interceptors.response.use((function(e){return e.data}),(function(e){return m.a.error("\u8bf7\u6c42\u9519\u8bef"+e.message),new Promise((function(){}))}));var j=w.a,S=a(516),C=a.n(S),x="/api";function N(e,t){return j({method:"POST",url:"".concat(x,"/login"),data:{username:e,password:t}})}var _=function(e){return new Promise((function(t,a){var n="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=").concat("3p49MVra6urFRGOT9s8UBWr2");C()(n,{},(function(e,a){if(e||0!==a.error)m.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25");else{var n=a.results[0].weather_data[0],r=n.dayPictureUrl,c=n.weather;t({dayPictureUrl:r,weather:c})}}))}))},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return j.get("".concat(x,"/categorys/"),{params:{page:e,per_page:t}})};function P(e){return j({method:"POST",url:"".concat(x,"/categorys/"),data:{name:e}})}var D=function(){return j("/api/products")},A=function(e,t){return j("/api/products",{params:{searchType:e,k:t}})};function U(e,t){return j({method:"PATCH",url:"".concat(x,"/products/").concat(e),data:t})}var F=function(e){return j("".concat(x,"/categorys/").concat(e))},T=function(e){return j("".concat(x,"/products/").concat(e))},R=function(){return j("".concat(x,"/categorys/"))},L=function(e){return j.delete("".concat(x,"/products/image/upload"),{params:{name:e}})},V=function(e){return j.post("".concat(x,"/products"),e)},z=function(e){var t=e.page,a=e.per_page;return j("".concat(x,"/roles"),{params:{page:t,per_page:a}})},M=function(e){return j.post("".concat(x,"/roles/"),{roleName:e})},K=function(e,t){return j.patch("".concat(x,"/roles/").concat(e),t)},q=function(){return j("".concat(x,"/users/"))},W=function(e){return j.post("".concat(x,"/users/"),e)},B=function(e,t){return j.patch("".concat(x,"/users/").concat(e),t)},J=function(e){return j.delete("".concat(x,"/users/").concat(e))},G=a(239),H=a.n(G),Q=(a(609),y.a.Item),$=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();a.props.form.getFieldsValue();a.props.form.validateFields(function(){var e=Object(d.a)(p.a.mark((function e(t,n){var r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.username,c=n.password,t){e.next=8;break}return e.next=4,N(r,c);case 4:0===(o=e.sent).status?(O.saveUser(o.data),a.props.history.replace("/")):(m.a.error(o.message),a.props.form.resetFields()),e.next=9;break;case 8:alert("\u9a8c\u8bc1\u5931\u8d25");case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatePwd=function(e,t,a){(t=t.trim())?t.length<3?a("\u5bc6\u7801\u5fc5\u987b\u5927\u4e8e3\u4f4d"):t.length>16?a("\u5bc6\u7801\u5fc5\u987b\u5c0f\u4e8e16\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?a():a("\u5bc6\u7801\u5fc5\u987b\u7531\u6570\u5b57\u6216\u5b57\u6bcd\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"):a("\u8bf7\u8f93\u5165\u5bc6\u7801")},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){if(O.getUser()._id)return r.a.createElement(E.a,{to:"/"});var e=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-header"},r.a.createElement("img",{src:H.a,alt:""}),r.a.createElement("h1",null,"React\u9879\u76ee \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf")),r.a.createElement("div",{className:"login-content"},r.a.createElement("h1",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement(y.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(Q,null,e("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{min:4,message:"\u7528\u6237\u540d\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"},{max:16,message:"\u7528\u6237\u540d\u4e0d\u80fd\u5927\u4e8e16\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u662f\u82f1\u6587\u5b57\u6bcd\u548c\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210"}]})(r.a.createElement(i.a,{prefix:r.a.createElement(l.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),r.a.createElement(Q,null,e("password",{initialValue:"",rules:[{validator:this.validatePwd}]})(r.a.createElement(i.a,{prefix:r.a.createElement(l.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))),r.a.createElement(Q,null,r.a.createElement(s.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u767b\u5f55")))))}}]),t}(n.Component),Z=y.a.create()($),X=(a(692),a(136)),Y=(a(694),a(135)),ee=a(93),te=[{title:"\u9996\u9875",key:"/home",icon:"home",public:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]}],ae=(a(697),Y.a.SubMenu),ne=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(c)))).getMenuNodes=function(e){return e.map((function(e){if(a.hasAuth(e)){if(e.children){var t=a.props.location.pathname;return e.children.find((function(e){return 0===t.indexOf(e.key)}))&&(a.openKey=e.key),r.a.createElement(ae,{key:e.key,title:r.a.createElement("span",null,r.a.createElement(l.a,{type:e.icon}),r.a.createElement("span",null,e.title))},a.getMenuNodes(e.children))}return r.a.createElement(Y.a.Item,{key:e.key},r.a.createElement(ee.b,{to:e.key},r.a.createElement(l.a,{type:e.icon}),e.title))}}))},a.hasAuth=function(e){var t=O.getUser(),a=t.role&&t.role.menus||[];return!(!e.public&&-1===a.indexOf(e.key)&&"admin"!==t.username)||!!e.children&&!!e.children.find((function(e){return-1!==a.indexOf(e.key)}))},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(te)}},{key:"render",value:function(){var e=this.props.location.pathname;return 0===e.indexOf("/product")&&(e="/product"),r.a.createElement("div",{className:"left-nav"},r.a.createElement(ee.b,{className:"left-nav-link",to:"/home"},r.a.createElement("img",{className:"left-nav-logo",src:H.a,alt:"logo\u56fe\u7247"}),r.a.createElement("h1",null,"\u5b89\u742a\u540e\u53f0")),r.a.createElement(Y.a,{onClick:this.handleClick,selectedKeys:[e],defaultOpenKeys:[this.openKey],mode:"inline",theme:"dark"},this.menuNodes))}}]),t}(n.Component),re=Object(E.g)(ne),ce=(a(169),a(74));function oe(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+se(t.getMonth()+1)+"-"+se(t.getDate())+" "+se(t.getHours())+":"+se(t.getMinutes())+":"+se(t.getSeconds())}function se(e){return Number(e)>10?e:"0".concat(e)}a(706),a(707);var ie=function(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))},le=ce.a.confirm,ue=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).handleLogout=function(){le({title:"\u786e\u8ba4\u8981\u9000\u51fa\u5417\uff1f",onOk:function(){O.removeUser(),a.props.history.replace("/login")},onCancel:function(){console.log("cancel")}})},a.getTitle=function(){var e="",t=a.props.location.pathname;return te.forEach((function(a){if(a.key===t)e=a.title;else if(a.children){var n=a.children.find((function(e){return 0===t.indexOf(e.key)}));n&&(e=n.title)}})),e},a.getWeather=Object(d.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("\u5e7f\u5dde");case 2:t=e.sent,n=t.dayPictureUrl,r=t.weather,a.setState({dayPictureUrl:n,weather:r});case 6:case"end":return e.stop()}}),e)}))),a.state={currentTime:Date.now(),dayPictureUrl:"",weather:""},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){e.setState({currentTime:Date.now()})}),1e3),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var e=O.getUser(),t=this.getTitle();return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-top"},"\u6b22\u8fce\uff0c",e.username,r.a.createElement(ie,{onClick:this.handleLogout},"\u9000\u51fa")),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("div",{className:"header-bottom-left"},t),r.a.createElement("div",{className:"header-bottom-right"},r.a.createElement("span",null,oe(this.state.currentTime)),r.a.createElement("img",{src:this.state.dayPictureUrl,alt:"weather"}),r.a.createElement("span",null,this.state.weather))))}}]),t}(n.Component),pe=Object(E.g)(ue),me=(a(708),function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home"},"\u6b22\u8fce\u8fdb\u5165react\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf")}}]),t}(n.Component)),de=(a(131),a(60)),he=(a(233),a(110)),fe=(a(719),y.a.Item),ge=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.categoryName,t=this.props.form.getFieldDecorator;return r.a.createElement(y.a,null,r.a.createElement(fe,null,t("categoryName",{initialValue:e||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b"}))))}}]),t}(n.Component),be=y.a.create()(ge),ve=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).handleGetData=Object(d.a)(p.a.mark((function e(){var t,n,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,n=t.data,r=t.status,c=t.total,o=t.message,0===r?a.setState({categorys:n,total:c}):m.a.error(o);case 8:case"end":return e.stop()}}),e)}))),a.initColumns=function(){a.columns=[{title:"\u5206\u7c7b\u7684\u540d\u79f0",dataIndex:"name",width:500},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement(ie,{onClick:function(){a.category=e,a.setState({showStatus:2})}},"\u4fee\u6539\u5206\u7c7b")}}]},a.handleReGetData=function(){var e=Object(d.a)(p.a.mark((function e(t,n){var r,c,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t,n);case 2:r=e.sent,c=r.data,o=r.status,s=r.message,0===o?a.setState({categorys:c}):m.a.error(s);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.onShowSizeChange=function(e,t){a.setState({page:e,per_page:t}),a.handleReGetData(e,t)},a.onChange=function(e){a.setState({page:e},(function(){var e=a.state,t=e.page,n=e.per_page;a.handleReGetData(t,n)}))},a.onOk=function(){a.form.validateFields(function(){var e=Object(d.a)(p.a.mark((function e(t,n){var r,c,o,s,i,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=14;break}if(r=a.state.showStatus,c=n.categoryName,o=null,2!==r){e.next=9;break}return s=a.category._id,e.next=8,p=s,d=c,j.patch("".concat(x,"/categorys/").concat(p),{name:d});case 8:o=e.sent;case 9:if(1!==r){e.next=13;break}return e.next=12,P(c);case 12:o=e.sent;case 13:0===o.status?(m.a.success("".concat(1===r?"\u6dfb\u52a0":"\u4fee\u6539","\u6210\u529f")),a.form.resetFields(),a.setState({showStatus:0}),i=a.state,l=i.per_page,u=i.page,a.handleReGetData(u,l)):(a.setState({showStatus:0}),m.a.error("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"));case 14:case"end":return e.stop()}var p,d}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.onCancel=function(){a.form.resetFields(),a.setState({showStatus:0})},a.showModal=function(){a.category={},a.setState({showStatus:1})},a.state={categorys:[],total:0,per_page:3,page:1,showStatus:0,loading:!1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.handleGetData();case 3:this.setState({loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement(s.a,{type:"primary",onClick:this.showModal},r.a.createElement(l.a,{type:"plus"}),"\u6dfb\u52a0"),a=this.category||{},n=this.state,c=n.categorys,o=n.total,i=n.per_page,u=n.page,p=n.loading,m={defaultPageSize:i,showQuickJumper:!0,total:o,onShowSizeChange:this.onShowSizeChange,showSizeChanger:!0,current:u,onChange:this.onChange};return r.a.createElement("div",{className:"category"},r.a.createElement(de.a,{extra:t,style:{width:"100%"}},r.a.createElement(he.a,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:c,pagination:m,loading:p})),r.a.createElement(ce.a,{title:1===this.state.showStatus?"\u6dfb\u52a0\u5206\u7c7b":"\u4fee\u6539\u5206\u7c7b",visible:0!==this.state.showStatus,onOk:this.onOk,onCancel:this.onCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement(be,{setForm:function(t){return e.form=t},categoryName:a.name})))}}]),t}(n.Component),ye=(a(205),a(61)),Ee=a(247),Oe=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).initProducts=Object(d.a)(p.a.mark((function e(){var t,n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.searchType,(r=t.k)&&a.setState({current:1}),c=null,!r){e.next=9;break}return e.next=6,A(n,r);case 6:c=e.sent,e.next=12;break;case 9:return e.next=11,D();case 11:c=e.sent;case 12:0===c.status?a.setState({products:c.data}):m.a.error(c.message);case 13:case"end":return e.stop()}}),e)}))),a.initColumns=function(){a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\xa5"+e}},{title:"\u72b6\u6001",render:function(e){var t=e.status,n=e._id,c="\u4e0b\u67b6",o="\u5728\u552e";return 2===t&&(c="\u4e0a\u67b6",o="\u5df2\u4e0b\u67b6"),r.a.createElement("span",null,r.a.createElement(s.a,{onClick:function(){return a.updateProStatus(n,t)}},c),r.a.createElement("span",null,o))}},{title:"\u64cd\u4f5c",width:120,render:function(e){return r.a.createElement("span",null,r.a.createElement(ie,{onClick:function(){return a.props.history.push({pathname:"/product/detail/".concat(e._id),state:{product:e,page:a.state.current}})}},"\u8be6\u60c5"),r.a.createElement(ie,{onClick:function(){return a.props.history.push({pathname:"/product/addupdate/".concat(e._id,"/").concat(a.state.current),state:{product:e}})}},"\u4fee\u6539"))}}]},a.handleChange=function(e){a.setState({k:e.target.value})},a.updateProStatus=Object(Ee.throttle)(function(){var e=Object(d.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=1===n?2:1,e.next=3,U(t,{status:n});case 3:0===e.sent.status?(m.a.success("\u66f4\u65b0\u6210\u529f"),a.initProducts()):m.a.error("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002");case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),2e3),a.onChange=function(e){a.setState({current:e})},a.state={loading:!1,products:[],searchType:"name",k:"",current:1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&(this.page=this.props.location.state.page),this.setState({loading:!0,current:this.page?this.page:1}),this.initColumns(),this.initProducts(),this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=r.a.createElement("span",null,r.a.createElement(ye.a,{style:{width:200},value:this.state.searchType,onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(ye.a.Option,{value:"name"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(ye.a.Option,{value:"desc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(i.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57",value:this.state.k,style:{width:200,margin:"0 10px"},onChange:this.handleChange}),r.a.createElement(s.a,{type:"primary",onClick:this.initProducts},"\u641c\u7d22")),a=r.a.createElement(s.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate/".concat(e.state.current))}},r.a.createElement(l.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1"),n=this.state,c=n.loading,o=n.products,u={defaultPageSize:3,showQuickJumper:!0,showSizeChanger:!0,current:n.current,onChange:this.onChange};return r.a.createElement(de.a,{title:t,extra:a},r.a.createElement(he.a,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:o,pagination:u,loading:c}))}}]),t}(n.Component),ke=(a(805),a(339)),we=(a(807),ke.a.Item),je=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).getCategoryName=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:0===(n=e.sent).status?a.setState({categoryName:n.data[0].name}):m.a.error(n.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.initGetProductDetail=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:0===(n=e.sent).status?a.setState({product:n.data[0]},(function(){a.getCategoryName(a.state.product.categoryId)})):(a.props.history.replace("/product"),m.a.error(n.message));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={product:{},categoryName:""},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.location.state&&(this.page=this.props.location.state.page,this.setState({product:this.props.location.state.product}),this.getCategoryName(this.props.location.state.product.categoryId));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.state.product)&&t._id){e.next=7;break}return a=this.props.match.params.id,e.next=5,this.initGetProductDetail(a);case 5:e.next=8;break;case 7:this.getCategoryName(t.categoryId);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement("span",null,r.a.createElement(ie,{onClick:function(){return e.props.history.replace({pathname:"/product",state:{page:e.page}})}},r.a.createElement(l.a,{type:"arrow-left"})),r.a.createElement("span",null,"\u5546\u54c1\u8be6\u60c5")),a=this.state.product,n=a.name,c=a.desc,o=a.price,s=(a.categoryId,a.detail),i=a.imgs;return r.a.createElement(de.a,{title:t,className:"detail"},r.a.createElement(ke.a,null,r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u5546\u54c1\u540d\u79f0\uff1a"),r.a.createElement("span",null,n)),r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u5546\u54c1\u63cf\u8ff0\uff1a"),r.a.createElement("span",null,c)),r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u5546\u54c1\u4ef7\u683c\uff1a"),r.a.createElement("span",null,o)),r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u6240\u5c5e\u5206\u7c7b\uff1a"),r.a.createElement("span",null,this.state.categoryName)),r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u5546\u54c1\u56fe\u7247\uff1a"),r.a.createElement("span",null,i&&i.length>0&&i.map((function(e,t){return r.a.createElement("img",{src:"http://localhost:5000/public/upload/"+e,key:t,className:"detail-img",alt:"product img"})})))),r.a.createElement(we,null,r.a.createElement("span",{className:"detail-left"},"\u5546\u54c1\u8be6\u60c5\uff1a"),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:s}}))))}}]),t}(n.Component),Se=(a(1260),a(531));function Ce(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var xe=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={previewVisible:!1,previewImage:"",fileList:[],imgs:[]},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Ce(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,c,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fileList,"done"!==(r=t.file).status){e.next=8;break}r=n[n.length-1],c=r.response.data,o=c.name,s=c.url,r.name=o,r.url=s,e.next=13;break;case 8:if("removed"!==r.status){e.next=13;break}return e.next=11,L(r.name);case 11:0===e.sent.status?m.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f"):m.a.error("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002");case 13:a.setState({fileList:n});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,c=r.a.createElement("div",null,r.a.createElement(l.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload"));return r.a.createElement("div",{className:"clearfix"},r.a.createElement(Se.a,{action:"/api/products/image/upload",listType:"picture-card",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange},n.length>=8?null:c),r.a.createElement(ce.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.imgs&&e.imgs.length>0&&t.imgs.length===t.fileList.length?{fileList:e.imgs.map((function(e,t){return{uid:-t,url:"http://localhost:5000/public/upload/"+e,status:"done",name:e}})),imgs:e.imgs}:null}}]),t}(r.a.Component),Ne=a(527),_e=a(133),Ie=a(528),Pe=a.n(Ie),De=a(529),Ae=a.n(De),Ue=(a(952),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={editorState:_e.EditorState.createEmpty(),detail:""},a.onEditorStateChange=Object(Ee.debounce)((function(e){a.setState({editorState:e})}),0),a.uploadImageCallBack=function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.open("POST","/api/products/image/upload");var r=new FormData;r.append("file",e),n.send(r),n.addEventListener("load",(function(){var e=JSON.parse(n.responseText);t({data:{link:e.data.url}})})),n.addEventListener("error",(function(){var e=JSON.parse(n.responseText);a(e)}))}))},a.getDetail=function(){var e=a.state.editorState;return Pe()(Object(_e.convertToRaw)(e.getCurrentContent()))},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement("div",null,r.a.createElement(Ne.Editor,{editorState:e,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}},toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorStyle:{height:400,overflow:"auto",lineHeight:1,border:"1px solid #000",padding:"0 0 10px 10px",margin:10},onEditorStateChange:this.onEditorStateChange}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.detail&&e.detail!==t.detail){var a=Ae()(e.detail),n=_e.ContentState.createFromBlockArray(a.contentBlocks);return{editorState:_e.EditorState.createWithContent(n),detail:e.detail}}return null}}]),t}(n.Component)),Fe=y.a.Item,Te=ye.a.Option,Re=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).getCategorys=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:0===(t=e.sent).status?a.setState({categorys:t.data}):m.a.error(t.message);case 4:case"end":return e.stop()}}),e)}))),a.validatePrice=function(e,t,a){1*t<=0?a("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0"):a()},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(d.a)(p.a.mark((function e(t,n){var r,c,o,s,i,l,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=19;break}if(r=n.name,c=n.price,o=n.desc,s=n.categoryId,i=a.pwRef.current.getImgs(),l=a.editorRef.current.getDetail(),u={name:r,price:c,desc:o,categoryId:s,detail:l,imgs:i},d=null,!a.isUpdate&&!a.state.isUpdate){e.next=13;break}return e.next=9,U(a.product&&a.product._id||a.state.product._id,u);case 9:0===(d=e.sent).status?(m.a.success("\u66f4\u65b0\u5546\u54c1\u4fe1\u606f\u6210\u529f"),a.props.history.replace("/product")):m.a.error(d.message),e.next=17;break;case 13:return e.next=15,V(u);case 15:0===(d=e.sent).status?(m.a.success("\u6dfb\u52a0\u5546\u54c1\u4fe1\u606f\u6210\u529f"),a.props.history.replace("/product")):m.a.error(d.message);case 17:e.next=20;break;case 19:m.a.error("\u5fc5\u586b\u9879\u7f3a\u5931\uff01");case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.pwRef=r.a.createRef(),a.editorRef=r.a.createRef(),a.state={categorys:[],product:{},isUpdate:!1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.location.state&&this.props.location.state.product&&(this.isUpdate=!!this.props.location.state.product._id,this.product=this.props.location.state.product);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getCategorys(),this.props.location.state||!this.props.match.params.id){e.next=6;break}return e.next=4,T(this.props.match.params.id);case 4:0===(t=e.sent).status?this.setState({product:t.data[0],isUpdate:!0}):m.a.error(t.message);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.isUpdate,a=this.product,n=void 0===a?{}:a;n._id||(n=this.state.product,t=this.state.isUpdate);var c=r.a.createElement("span",null,r.a.createElement(ie,{onClick:function(){return e.props.history.replace({pathname:"/product",state:{page:Number(e.props.match.params.page)}})}},r.a.createElement(l.a,{type:"arrow-left"})),r.a.createElement("span",null,t?"\u66f4\u65b0\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1")),o=this.props.form.getFieldDecorator;return r.a.createElement(de.a,{title:c,style:{marginBottom:20}},r.a.createElement(y.a,Object.assign({},{labelCol:{span:2},wrapperCol:{span:8}},{onSubmit:this.handleSubmit}),r.a.createElement(Fe,{label:"\u5546\u54c1\u540d\u79f0"},o("name",{initialValue:n.name||"",rules:[{required:!0,message:"\u5546\u54c1\u540d\u79f0\u4e3a\u5fc5\u9009\u9879"}]})(r.a.createElement(i.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(Fe,{label:"\u5546\u54c1\u63cf\u8ff0"},o("desc",{initialValue:n.desc||"",rules:[{required:!0,message:"\u5546\u54c1\u63cf\u8ff0\u4e3a\u5fc5\u9009\u9879"}]})(r.a.createElement(i.a,{type:"text",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}))),r.a.createElement(Fe,{label:"\u5546\u54c1\u4ef7\u683c"},o("price",{initialValue:n.price||"",rules:[{validator:this.validatePrice},{required:!0,message:"\u5546\u54c1\u4ef7\u683c\u4e3a\u5fc5\u9009\u9879"}]})(r.a.createElement(i.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"}))),r.a.createElement(Fe,{label:"\u5546\u54c1\u5206\u7c7b"},o("categoryId",{initialValue:n.categoryId||"",rules:[{required:!0,message:"\u5546\u54c1\u5206\u7c7b\u4e3a\u5fc5\u9009\u9879"}]})(r.a.createElement(ye.a,null,r.a.createElement(Te,{value:""},"\u672a\u9009\u62e9"),this.state.categorys.length>0&&this.state.categorys.map((function(e){return r.a.createElement(Te,{value:e._id,key:e._id},e.name)}))))),r.a.createElement(Fe,{label:"\u5546\u54c1\u56fe\u7247"},r.a.createElement("div",null,r.a.createElement(xe,{ref:this.pwRef,imgs:n.imgs||this.state.product.imgs}))),r.a.createElement(Fe,{label:"\u5546\u54c1\u8be6\u60c5",wrapperCol:{span:20}},r.a.createElement("div",null,r.a.createElement(Ue,{ref:this.editorRef,detail:n.detail||this.state.product.detail}))),r.a.createElement(Fe,null,r.a.createElement(s.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"))))}}]),t}(n.Component),Le=y.a.create()(Re),Ve=(a(953),function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/product",exact:!0,component:Oe}),r.a.createElement(E.b,{path:"/product/detail/:id",component:je}),r.a.createElement(E.b,{path:"/product/addupdate/:id/:page",component:Le}),r.a.createElement(E.b,{path:"/product/addupdate/:page",component:Le}),r.a.createElement(E.a,{to:"/product"}))}}]),t}(n.Component)),ze=a(235),Me=(a(275),a(160)),Ke=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).showTotal=function(e){return"\u603b\u5171".concat(e,"\u6761")},a.onChange=function(e,t){a.setState({current:e}),a.props.handleChange&&a.props.handleChange(e,t)},a.onShowSizeChange=function(e,t){a.setState({current:1},(function(){a.props.handleChange&&a.props.handleChange(e,t)}))},a.state={current:1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.pageSizeOptions,a=e.total;return r.a.createElement(n.Fragment,null,a?r.a.createElement("div",{className:"pagination",style:{marginTop:20,float:"right"}},r.a.createElement(Me.a,{pageSizeOptions:t,defaultPageSize:Number(t[0]),showQuickJumper:!0,showSizeChanger:!0,showTotal:this.showTotal,current:this.state.current,total:a,onChange:this.onChange,onShowSizeChange:this.onShowSizeChange,style:{float:"right"}})):"")}}]),t}(n.Component);Ke.defaultProps={pageSizeOptions:["2","3","5","10"],total:0};var qe=Ke,We=y.a.Item,Be=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(y.a,null,r.a.createElement(We,Object.assign({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:16}}),e("roleName",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))))}}]),t}(n.Component),Je=Be=y.a.create()(Be),Ge=(a(954),a(338)),He=y.a.Item,Qe=Ge.a.TreeNode,$e=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).getCheckedKeys=function(){return a.state.checkedKeys},a.getNodes=function(e){return e.reduce((function(e,t){return e.push(r.a.createElement(Qe,{title:t.title,key:t.key},t.children?a.getNodes(t.children):null)),e}),[])},a.onCheck=function(e){console.log("checkedKeys",e),a.setState({checkedKeys:e})},a.state={checkedKeys:[],_id:""},a.nodes=a.getNodes(te),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.role;return r.a.createElement("div",null,r.a.createElement(He,Object.assign({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:16}}),r.a.createElement(i.a,{value:e.name,disabled:!0})),r.a.createElement(Ge.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:this.state.checkedKeys,onSelect:this.onSelect,onCheck:this.onCheck},r.a.createElement(Qe,{title:"\u5e73\u53f0\u6743\u9650",key:"all"},this.nodes?this.nodes:null)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.role.menus;return e.closeAuth||e.role._id!=t._id?{checkedKeys:a,_id:e.role._id}:null}}]),t}(n.PureComponent);$e.defaultProps={role:{},closeAuth:!1};var Ze=$e,Xe=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).initColumns=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:oe},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:oe},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement(ie,{onClick:function(){return a.showAuth(e)}},"\u8bbe\u7f6e\u6743\u9650")}}]},a.getRoles=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,z(t);case 3:0===(n=e.sent).status?a.setState({roles:n.data,total:n.total,loading:!1}):(a.setState({loading:!1}),m.a.error(n.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeCurPageOrPageSize=function(e,t){a.setState({current:e,pageSize:t}),a.getRoles({page:e,per_page:t})},a.addRole=function(){a.form.validateFields(function(){var e=Object(d.a)(p.a.mark((function e(t,n){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return r=n.roleName,e.next=4,M(r);case 4:0===(c=e.sent).status?(m.a.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),a.setState({isShowAdd:!1}),a.getRoles({page:1,per_page:3})):m.a.error(c.message),e.next=9;break;case 8:m.a.error("\u8868\u5355\u6821\u9a8c\u4e0d\u901a\u8fc7");case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.showAuth=function(e){a.role=e,a.setState({isShowAuth:!0,closeAuth:!1})},a.udpateRole=Object(d.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(ze.a)(a),n=t.role,(r={}).menus=a.authRef.current.getCheckedKeys(),r.auth_name=O.getUser().username,r.auth_time=Date.now(),e.next=7,K(n._id,r);case 7:0===e.sent.status?(m.a.success("\u66f4\u65b0\u89d2\u8272\u6743\u9650\u6210\u529f"),a.setState({isShowAuth:!1}),a.getRoles({page:a.state.current,per_page:a.state.pageSize})):m.a.error("\u66f4\u65b0\u89d2\u8272\u6743\u9650\u5931\u8d25");case 9:case"end":return e.stop()}}),e)}))),a.initColumns(),a.authRef=r.a.createRef(),a.state={roles:[],total:0,loading:!1,isShowAdd:!1,isShowAuth:!1,current:1,pageSize:3,closeAuth:!1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.getRoles({page:1,per_page:3})}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.total,c=t.loading,o=t.isShowAdd,i=t.isShowAuth,l=t.closeAuth,u=r.a.createElement(s.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})}},"\u6dfb\u52a0\u89d2\u8272");return r.a.createElement(de.a,{title:u},r.a.createElement(he.a,{bordered:!0,rowKey:"_id",dataSource:a,columns:this.columns,pagination:!1,loading:c}),r.a.createElement(qe,{total:n,handleChange:this.onChangeCurPageOrPageSize,pageSizeOptions:["3","5","10","20"]}),r.a.createElement(ce.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:o,onOk:this.addRole,onCancel:function(){e.form.resetFields(),e.setState({isShowAdd:!1})}},r.a.createElement(Je,{setForm:function(t){return e.form=t}})),r.a.createElement(ce.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:i,onOk:this.udpateRole,onCancel:function(){e.setState({isShowAuth:!1,closeAuth:!0})}},r.a.createElement(Ze,{role:this.role,closeAuth:l,ref:this.authRef})))}}]),t}(n.Component),Ye=y.a.Item,et=ye.a.Option,tt=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).props.setForm(a.props.form),a.state={selectValue:"\u8bf7\u9009\u62e9"},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.user||{},a=this.props.roles;return r.a.createElement(y.a,{labelCol:{span:4},wrapperCol:{span:18}},r.a.createElement(Ye,{label:"\u7528\u6237\u540d"},e("username",{initialValue:t.username||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),t._id?null:r.a.createElement(Ye,{label:"\u5bc6\u7801"},e("password",{initialValue:t.password||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",type:"password"}))),r.a.createElement(Ye,{label:"\u90ae\u7bb1"},e("email",{initialValue:t.email||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(Ye,{label:"\u624b\u673a\u53f7"},e("phone",{initialValue:t.phone||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"}]})(r.a.createElement(i.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"}))),r.a.createElement(Ye,{label:"\u6240\u5c5e\u89d2\u8272"},e("role_id",{initialValue:t.role_id||"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89d2\u8272"}]})(r.a.createElement(ye.a,null,r.a.createElement(et,{value:""},"\u8bf7\u9009\u62e9"),a.length>0&&a.map((function(e){return r.a.createElement(et,{value:e._id,key:e._id},e.name)}))))))}}]),t}(n.Component);tt.defaultProps={roles:[]};var at=y.a.create()(tt),nt=ce.a.confirm,rt=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).initColumns=function(){a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:oe},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.roleName[e]}},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(ie,{onClick:function(){return a.handleEditUser(e)}},"\u4fee\u6539"),r.a.createElement(ie,{onClick:function(){return a.handleDeleteUser(e._id)}},"\u5220\u9664"))}}]},a.getUserList=Object(d.a)(p.a.mark((function e(){var t,n,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:0===(t=e.sent).status?(n=t.data,r=n.roles,c=n.users,o=n.total,a.roleName=r.reduce((function(e,t){return e[t._id]=t.name,e}),{}),a.userList=c,a.setState({userList:c.slice(0,3),roles:r,total:o})):m.a.error("\u83b7\u53d6\u7528\u6237\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002");case 4:case"end":return e.stop()}}),e)}))),a.handleEditUser=function(e){a.setState({formVisible:!0}),a.user=e},a.handleDeleteUser=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:nt({title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u7528\u6237\u5417\uff1f",okType:"danger",onOk:function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t);case 2:0===e.sent.status?(m.a.success("\u5220\u9664\u7528\u6237\u6210\u529f"),a.getUserList()):m.a.error("\u5220\u9664\u7528\u6237\u5931\u8d25");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){console.log("Cancel")}}),a.setState({formVisible:!1});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleOk=function(){a.form.validateFields(function(){var e=Object(d.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=14;break}if(a.user&&a.user._id){e.next=7;break}return e.next=4,W(n);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,B(a.user._id,n);case 9:e.t0=e.sent;case 10:0===e.t0.status?(m.a.success((a.user&&a.user._id?"\u66f4\u65b0":"\u6dfb\u52a0")+"\u7528\u6237\u6210\u529f"),a.getUserList()):m.a.error("\u6dfb\u52a0\u7528\u6237\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"),e.next=15;break;case 14:m.a.error("\u8868\u5355\u6821\u9a8c\u4e0d\u901a\u8fc7");case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),a.setState({formVisible:!1})},a.handleCancel=function(){a.user={},a.form.resetFields(),a.setState({formVisible:!1})},a.handleChange=function(e,t){a.setState({userList:a.userList.slice((e-1)*t,e*t)})},a.initColumns(),a.state={userList:[],roles:[],total:0,formVisible:!1},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getUserList();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement(s.a,{icon:"plus",type:"primary",onClick:function(){return e.setState({formVisible:!0})}},"\u6dfb\u52a0\u7528\u6237"),a=this.state.userList;return r.a.createElement(de.a,{title:t},r.a.createElement(he.a,{bordered:!0,dataSource:a,columns:this.columns,pagination:!1,rowKey:"_id"}),r.a.createElement(qe,{total:this.state.total,handleChange:this.handleChange,pageSizeOptions:["3","5","10","20"]}),r.a.createElement(ce.a,{title:this.user&&this.user._id?"\u66f4\u65b0\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:this.state.formVisible,onOk:this.handleOk,onCancel:this.handleCancel},r.a.createElement(at,{roles:this.state.roles,user:this.user||{},setForm:function(t){return e.form=t}})))}}]),t}(n.Component),ct=a(530),ot=a.n(ct),st=a(332),it=a.n(st),lt=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).getOption=function(e,t){return{title:{text:"\u6d4b\u8bd5\u6570\u636e"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u89c6\u9891\u5e7f\u544a","\u8054\u76df\u5e7f\u544a","\u90ae\u4ef6\u8425\u9500","\u76f4\u63a5\u8bbf\u95ee","\u641c\u7d22\u5f15\u64ce"]},yAxis:{},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",data:[{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}],roseType:"angle",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"}}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},a.update=function(){a.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},a.state={sales:[5,20,36,10,10,20],stores:[6,10,25,20,15,10]},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.stores,a=e.sales;return it.a.registerTheme("my_theme",{backgroundColor:"#f4cccc"}),r.a.createElement("div",null,r.a.createElement(de.a,null,r.a.createElement(s.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(de.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(ot.a,{option:this.getOption(a,t),theme:"my_theme"})))}}]),t}(n.Component),ut=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"line")}}]),t}(n.Component),pt=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"pie")}}]),t}(n.Component),mt=X.a.Sider,dt=X.a.Content,ht=(X.a.Header,X.a.Footer),ft=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("user")||"{}"),t=e.role&&e.role.menus||[];if(t&&t.length>0){var a=this.props.history.location.pathname;if(console.log(t.toString().indexOf(a)),-1===t.toString().indexOf(a)){var n=/^(\/[\w\d_-]+)(?:\/?)/.exec(a)&&/^(\/[\w\d_-]+)(?:\/?)/.exec(a)[1]||a;if(!t.toString().indexOf(n))return r.a.createElement(E.a,{to:"/home"})}}return e._id?r.a.createElement(X.a,{style:{height:"100%"}},r.a.createElement(mt,null,r.a.createElement(re,null)),r.a.createElement(X.a,null,r.a.createElement(pe,null),r.a.createElement(dt,{style:{background:"white",margin:"20px",borderBox:"box-sizing"}},r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/home",component:me}),r.a.createElement(E.b,{path:"/category",component:ve}),r.a.createElement(E.b,{path:"/product",component:Ve}),r.a.createElement(E.b,{path:"/role",component:Xe}),r.a.createElement(E.b,{path:"/user",component:rt}),r.a.createElement(E.b,{path:"/charts/bar",component:lt}),r.a.createElement(E.b,{path:"/charts/line",component:ut}),r.a.createElement(E.b,{path:"/charts/pie",component:pt}),r.a.createElement(E.a,{to:"/home"}))),r.a.createElement(ht,{style:{textAlign:"center",lineHeight:"1",height:60}},"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\u8bbf\u95ee\u6548\u679c\u66f4\u4f73"))):r.a.createElement(E.a,{to:"/login"})}}]),t}(n.Component);var gt=function(){return r.a.createElement(ee.a,null,r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/login",component:Z}),r.a.createElement(E.b,{path:"/",component:ft}),r.a.createElement(E.b,{component:ft})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},239:function(e,t,a){e.exports=a.p+"static/media/logo.f089d709.jpg"},534:function(e,t,a){e.exports=a(1259)},609:function(e,t,a){},697:function(e,t,a){},706:function(e,t,a){},707:function(e,t,a){},708:function(e,t,a){},719:function(e,t,a){},807:function(e,t,a){},953:function(e,t,a){}},[[534,1,2]]]);
//# sourceMappingURL=main.bb483f5c.chunk.js.map